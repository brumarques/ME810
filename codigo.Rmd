---
title: "Validari - Linearidade"
author: "Estatística 2017"
date: "11 de setembro de 2017"
header-includes:
   - \usepackage{bbm}
output: html_document

---
# Introdução

A Validari é uma *start up* que foi criada com o intuito de auxiliar os laboratórios farmacêuticos na validação de métodos analíticos. A proposta da empresa é criar um *software online*, que seja capaz de validar métodos analíticos de forma ágil e correta estatisticamente.  
O objetivo do nosso projeto é avaliar e revisar a metodologia usada para validação da Linearidade, explicando de forma clara o passo a passo da metodologia mais adequada.  



# Análise descritiva   

A Estatística descritiva fornece resumos simples sobre a amostra e sobre as observações que foram feitas. Tal resumo pode ser quantitativo ou visual.     
Como geralmente os dados são “concentração” e “área”, sabemos que eles são **positivos** e **não nulos** , ou seja, maiores que zero. Sugerimos, então, fazer um gráfico de dispersão e calcular as medidas resumo.    
Pelo gráfico de dispersão, será possível observar se há valores discrepantes ou se há inconsistência nos dados (erro de digitação, por exemplo).   
Pelas medidas resumo verificamos se os valores tem as características esperadas. Tais medidas consistem em valores máximo e mínimo, média e desvio padrão.    
Lembrando que **não** devemos retirar um valor da amostra, por mais que ele seja muito diferente dos demais, exceto quando há **certeza** de que foi um erro humano.

```{r, echo=FALSE, warning=FALSE}
library(readxl) #biblioteca para ler o excel
library(knitr)
data <- read_excel("C:/Users/TEMP/Downloads/data.xlsx") #leitura dos dados
plot(data, main="Gráfico de Dispersão", xlab="Concentração", ylab="Área") #grafico de dispersao

```

**Medias Resumo**  


|        | Concentração | Área     |
|--------|--------------|----------|
| Mínimo | `r min(data$Concentração)`         | `r round(min(data$Área), 2)`  |
| Máximo | `r max(data$Concentração)`        | `r formatC(max(data$Área), digits = 7)` |
| Média  | `r mean(data$Concentração)`         | `r formatC(mean(data$Área), digits = 7)` |


# Regressão linear e significância dos parâmetros (curva analítica)  

Estatisticamente, a melhor forma de avaliar a linearidade é através da regressão linear, pois é a metodologia que estuda a relação entre uma variável de interesse (Área) e outras variáveis (Concentração). Com a regressão, vemos qual a melhor reta $(y=ax + b)$ a ser traçada que se ajusta melhor nesses dados, ou seja, qual reta faz com que a distância entre os pontos e a reta ajustada seja a menor possível, minimizando o erro e estimando com maior precisão, por isso a estimação é feita através do Método dos Mínimos Quadrados.  

```{r,echo=FALSE }
fit = lm(Área~Concentração, data=data)
plot(Área~Concentração, data=data, main="Curva Analítica")
abline(fit, col="red")
r= summary(fit)$r.squared

```

Acima, temos a reta de regressão (curva analítica) traçada em cima dos pontos. A reta encontrada foi:   
$$Y = `r format(coefficients(fit)[2], scientific=FALSE)`X + `r round(coefficients(fit)[1], 2)`$$
Ou seja, $a=`r format(coefficients(fit)[2], scientific=FALSE)`$ e $b=`r round(coefficients(fit)[1], 2)`$.   

| Parâmetro 	| Estimativa                                          	| p-valor                             	|
|-----------	|-----------------------------------------------------	|-------------------------------------	|
| a         	| `r  format(coefficients(fit)[2], scientific=FALSE)` 	| `r summary(fit)$coefficients[2,4]`  	|
| b         	| `r round(coefficients(fit)[1], 2)`                  	| `r summary(fit)$coefficients[1,4]`  	|    

# Qualidade de Ajuste e homocedasticidade

O passo seguinte após determinarmos a metodologia e ajustarmos o modelo é verificar a qualidade do ajuste do modelo aos dados. Algumas técnicas podem ser utilizadas, entre elas a  “análise de variância da regressão”(ANOVA)  que é uma das mais utilizadas. 

Tabela ANOVA

Para avaliar se a reta foi bem ajustada, ou seja, se os coeficientes da reta se ajustam bem aos pontos, vamos observar o p-valor. Ele nos mostra se cada coeficiente é significativo ou não para o modelo.
Dado que o nível de significância é 0.05, se:
    - P-valor < 0.05, há evidências para de que o parâmetro é significativo, ou seja, ele é diferente de zero, e a linearidade é aceita.     - P-valor > 0,05, não há evidências para de que o parâmetro é significativo, ou seja, ele é igual a zero e não significativo para o modelo. Neste caso, a linearidade não é aceita.

Para verificarmos a homocedasticidade do modelo, ou seja, se temos variância constante, vamos utilizar o Teste de Cochran, que consiste em comparar a maior variância com as demais.

https://www.rdocumentation.org/packages/outliers/versions/0.14/topics/cochran.test

https://stat.ethz.ch/pipermail/r-help/2007-November/144978.html


# Conclusão

Através de métodos estatísticos temos condição de validar a linearidade, partindo inicialmente com uma estatística descritiva para dar uma visão geral das concentrações e suas áreas , seguindo de uma regressão linear para nos mostrarmos estatisticamente a linearidade, concluindo com testes para verificação de alguns pontos importantes como independência, normalidade e homocedasticidade.  

```{r,echo=FALSE }

```



